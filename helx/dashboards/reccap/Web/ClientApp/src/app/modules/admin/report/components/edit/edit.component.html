<mat-tab-group mat-stretch-tabs class="mat-elevation-z2" color="primary" [formGroup]="entityForm">
    <mat-tab label="General">
        <div class="p-2">
            <mat-form-field class="col-md" *ngIf="entityForm.controls.name;let control">
                <input matInput placeholder="Name" formControlName="name">
                <mat-error *ngIf="control.errors?.required;let error">Required</mat-error>
                <mat-error *ngIf="control.errors?.maxlength;let error">Cannot be more than
                    {{error.requiredLength}} characters long</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>
            <mat-form-field class="col-md" *ngIf="entityForm.controls.shortDescription;let control">
                <textarea matInput cdkTextareaAutosize="true" cdkAutosizeMinRows="5" cdkAutosizeMaxRows="10"
                    placeholder="Short Description" [formControl]="$any(control)"></textarea>
                <mat-error *ngIf="control.errors?.maxlength;let error">Cannot be more than
                    {{error.requiredLength}} characters long</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md" *ngIf="entityForm.controls.shortDescription;let control">
                <input matInput placeholder="Description" [formControl]="$any(control)">
                <mat-error *ngIf="control.errors?.maxlength;let error">Cannot be more than
                    {{error.requiredLength}} characters long</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.isActive;let control">
                <mat-label>Active</mat-label>
                <mat-select [formControl]="$any(control)">
                    <mat-option [value]="true">Yes</mat-option>
                    <mat-option [value]="false">No</mat-option>
                </mat-select>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.isVisible;let control">
                <mat-label>Visible</mat-label>
                <mat-select [formControl]="$any(control)">
                    <mat-option [value]="true">Yes</mat-option>
                    <mat-option [value]="false">No</mat-option>
                </mat-select>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.isPublic;let control">
                <mat-label>Public</mat-label>
                <mat-select [formControl]="$any(control)">
                    <mat-option [value]="true">Yes</mat-option>
                    <mat-option [value]="false">No</mat-option>
                </mat-select>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.displayCategory;let control">
                <mat-label>Display Category</mat-label>
                <mat-select [formControl]="$any(control)">
                    <mat-option *enums="'ReportDisplayCategory';let value" [value]="value.id">
                        {{value.text}}</mat-option>
                </mat-select>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.defaultSort;let control">
                <input matInput placeholder="Default Sort" formControlName="defaultSort">
                <mat-error *ngIf="control.errors?.maxlength;let error">Cannot be more than
                    {{error.requiredLength}} characters long</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-4" *ngIf="entityForm.controls.reportTypeId;let control">
                <mat-label>Report Type</mat-label>
                <mat-select [formControl]="$any(control)">
                    <mat-option *category-types="'ReportType';let value" [value]="value.id">
                        {{value.text}}</mat-option>
                </mat-select>
                <mat-error *ngIf="control.errors?.required;let error">Required</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>

            <mat-form-field class="col-md-6" *ngIf="entityForm.controls.roles;let control">
                <mat-label>Roles</mat-label>
                <mat-select [formControl]="$any(control)" multiple>
                    <mat-option *roles="'';let value" [value]="value">
                        {{value.text}}</mat-option>
                </mat-select>
                <mat-error *ngIf="control.errors?.minlength;let error">At least one role is required.</mat-error>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>
            <mat-form-field class="col-md-6" *ngIf="entityForm.controls.chartTypes;let control">
                <mat-label>Chart Types</mat-label>
                <mat-select [formControl]="$any(control)" multiple>
                    <mat-option *ngFor="let chartType of chartTypeItems" [value]="chartType">
                        {{chartType.text}}</mat-option>
                </mat-select>
                <mat-error *ngFor="let error of control.errors?.serverError;">{{error}}</mat-error>
            </mat-form-field>
        </div>

    </mat-tab>
    <mat-tab>
        <ng-template mat-tab-label>
            SQL Query
        </ng-template>
        <!-- <ace-editor formControlName="queryText" [mode]="'sqlserver'" [theme]="'clouds'" [options]="options"
            style="min-height: 200px; width:100%; overflow: auto;"></ace-editor> -->
        <td-code-editor #editor class="editor" theme="vs" language="sql" formControlName="queryText" flex>
        </td-code-editor>
        <mat-error *ngFor="let error of entityForm.controls.queryText.errors?.serverError;">{{error}}</mat-error>
        <mat-action-row>
            <button mat-button color="primary" (click)="populateColumns($event)"><i class="fa fa-plus"></i>
                Populate columns</button>
        </mat-action-row>
    </mat-tab>
    <mat-tab>
        <ng-template matTabLabel>
            <div layout="row" layout-align="center center" color="warn">
                Columns
                <td-notification-count color="primary" [notifications]="entityForm.value.columns.length">
                </td-notification-count>
            </div>
        </ng-template>
        <app-edit-columns formControlName="columns"></app-edit-columns>
    </mat-tab>
    <mat-tab>
        <ng-template matTabLabel>
            <div layout="row" layout-align="center center" color="warn">
                Parameters
                <td-notification-count color="primary" [notifications]="entityForm.value.parameters.length">
                </td-notification-count>
            </div>
        </ng-template>
        <app-edit-parameters formControlName="parameters"></app-edit-parameters>
    </mat-tab>
</mat-tab-group>